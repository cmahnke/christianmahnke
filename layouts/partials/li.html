{{- $class := "" -}}
{{- if ne .Params.type nil -}}
    {{- $class = .Params.type -}}
{{- end -}}
{{- $previewWidth :=  slice "1280" "640" "320" -}}
{{- $class = printf "%s %s" $class (.Scratch.Get "class") -}}
<div class="post {{ $class }}">
    <div class="content">
        <h2 class="post-title"><a class="readmore" href="{{ .RelPermalink}}" title="{{ i18n "readmore" }}">{{ .Title }}</a></h2>
        <div class="post-date">

          {{- .Date | time.Format ":date_full" -}}
        </div>
        <div class="post-body">
          {{- with .Params.preview -}}
            {{- $src := . -}}
            {{- $class := "" -}}
            {{- if reflect.IsMap . -}}
              {{- $src = index . "image" -}}
              {{- $class = index . "class" -}}
            {{- end -}}
            <div class="post-preview">
              <picture>
                {{- range $previewWidth -}}
                  {{- $imgRes := $.Page.Resources.Get $src -}}
                  <source media="(min-width:{{ . }}px)" srcset="{{ ($imgRes.Resize (printf "%sx" .)).RelPermalink }}">
                {{- end -}}
                {{- $imgRes := $.Page.Resources.Get $src -}}
                <a title="{{ $.Title}}" href="{{ $.RelPermalink }}">
                  <img src="{{ ($imgRes.Resize (printf "%sx" "1280")).RelPermalink }}" alt="{{ $.Title }}" {{ if ne $class "" }}class="{{ $class }}"{{ end }} />
                </a>
              </picture>
            </div>
          {{- end -}}

          {{ .Summary }}
        </div>
        <div class="meta">
            <a class="readmore" href="{{ .RelPermalink}}" title="{{ i18n "readmore" }}"><button class="button-gradient">{{ i18n "readmore" }}</button></a>
            {{ partial "meta/tags.html" . }}
        </div>
    </div>
</div>
