<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>JPEG XL Â· Christian Mahnke</title>
    <meta name="author" content="Christian Mahnke">
<meta http-equiv="Content-Language" content="en">

<meta name="description" content="Since my blogs are managed on GitHub, the images have to be stored as storage-saving as possible&hellip;">
<meta property="og:type" content="article" /><meta property="og:url" content="https://christianmahnke.de/en/post/jpeg-xl/" /><meta property="og:title" content="JPEG XL" />
<meta property="og:image" content="https://christianmahnke.de/en/post/jpeg-xl/ogPreview.en_hu_cd0f51adf786f23b.jpg" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />



<meta name="keywords" content=", Digital images, Projektemacher.org, IIIF">
<meta name="generator" content="Hugo 0.152.2">
<meta name="projektemacher.org:build-date" content="2025-11-01 23:48:47.316538693 &#43;0000 UTC m=&#43;155.295759898">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no">

<link rel="icon" type="image/svg+xml" href="https://christianmahnke.de/images/cm.svg">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <meta name="theme-color" content="#701611"><link href="https://christianmahnke.de/css/3dcde2e700baa65d3814003bfc8fa7f9.min.df28516c1fc60576c14374d9f01d3ea3a0cab312068a1b7d21ed18bf6ff6017d.css" rel="stylesheet" integrity="sha256-3yhRbB/GBXbBQ3TZ8B0&#43;o6DKsxIGiht9Ie0Yv2/2AX0=">
<script src="https://christianmahnke.de/js/b6784f3604da5279445eddee5a9c2760.min.8d20d0d0b625ff21a88d8466b0f54a96635d99caa181e63f4be4ed8c422c4e43.js" integrity="sha256-jSDQ0LYl/yGojYRmsPVKlmNdmcqhgeY/S+TtjEIsTkM="></script>
<link rel="icon" type="image/png" href="https://christianmahnke.de/images/favicon-32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://christianmahnke.de/images/favicon-16.png" sizes="16x16">
    

    <link rel="shortcut icon" href="https://christianmahnke.de/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://christianmahnke.de/images/favicon.ico" type="image/x-icon">

    </head><body class="section-post dir-postjpeg-xl  ">
      <a name="top"></a>
      <div class="page-wrapper">
        <div class="main">
          <header class="header header-main" id="head" data-sticky-class="sticky-top">
    <div class="wrapper">
        <label class="menu-open" for="menu-toggle">
            <i class="menu-open-icon"></i>
        </label>
        <div class="menu">
            <nav class="top top-menu">
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="menu-icon"></i></label>
    <ul class="navigation-list"><li class="navigation-item navto-"><a class="navigation-link" href="https://christianmahnke.de/en/" title="Focuses">Focuses<i class="link-icon"></i></a></li><li class="navigation-item navto-collections"><a class="navigation-link" href="https://christianmahnke.de/en/collections" title="Collections">Collections<i class="link-icon"></i></a></li><li class="navigation-item current navto-post"><a class="navigation-link" href="https://christianmahnke.de/en/post" title="Blog">Blog<i class="link-icon"></i></a></li><li class="navigation-item navto-links"><a class="navigation-link" href="https://christianmahnke.de/en/links" title="Links">Links<i class="link-icon"></i></a></li><li class="navigation-item navto-about"><a class="navigation-link" href="https://christianmahnke.de/en/about" title="About">About<i class="link-icon"></i></a></li><li class="navigation-item navto-search"><form action="https://christianmahnke.de/en/search/" method="get" class="search-form" id="menu-search-form"><input name="q" type="text" placeholder="Search" class="search-input" id="menu-search-input"><button type="submit" class="search-button" id="menu-search-button"><i class="search-icon"></i></button></form></li><li class="navigation-item lang">
              <a href="https://christianmahnke.de/post/jpeg-xl/" title="Deutsch">Deutsch</a>
            </li></ul>
  </nav>
        </div>
        <div class="home-link">
            <a href="https://christianmahnke.de/"><h1 class="header-title">Christian Mahnke</h1></a>
        </div></div>
    <div class="header-spacer"></div>
    <a href="#top">
        <div class="backToTop"></div>
    </a>
</header>
<div class="content-container single">
    
<div class="post ">
  <div class="content">
      <h1 class="post-title">JPEG XL</h1><div class="date">
          <time class="post-data" datetime="2021-04-17T11:22:44&#43;02:00">Saturday, April 17, 2021</time>
        </div><div class="post-body"><p>Since my blogs are managed on GitHub, the images have to be stored as storage-saving as possible&hellip;</p>
<h1 id="why-jpeg-xl">Why JPEG XL?</h1>
<p>
      
        
      <a data-wikidata-entity="Q72885392" href="https://en.wikipedia.org/wiki/JPEG_XL" target="_blank">JPEG XL</a> is a new format for raster images, in fact, is&rsquo;s so recent (at the time this text was written) there haven&rsquo;t even been an entry in the German Wikipedia.</p>
<p>You can read there what exactly JPEG XL does differently or better than the well-known JPEG. We limit ourselves here to the advantages for the Projektemacher blogs:</p>
<ul>
<li>Less storage space required</li>
<li>Lossless compression available</li>
</ul>
<p>Disadvantages are currently:</p>
<ul>
<li>Few programs can handle it</li>
<li>The existing algorithms are not yet optimized - it is slower</li>
</ul>
<p>The reference implementation can be found on <a href="https://gitlab.com/wg1/jpeg-xl" target="_blank">GitLab</a>.</p>
<h1 id="how">How?</h1>
<p>Since the conversion to IIIF derivatives on GitHub is done by a <a href="https://github.com/cmahnke/iiif-action" target="_blank">Docker image</a>, the easiest way to integrate the use of the new format into the tool chain is to add JPEG XL support to this image. For the used <a href="https://github.com/libvips/libvips" target="_blank">LibVIPS</a> there is a <a href="https://github.com/libvips/libvips/pull/2181" target="_blank">Pull Request</a>, which supports the JPEG XL reference implementation. This is now built into a variant of the image for conversion:</p>
<pre tabindex="0"><code>docker pull ghcr.io/cmahnke/iiif-action:latest-jxl
</code></pre><h1 id="preparations">Preparations</h1>
<h2 id="start-an-interactive-container">Start an interactive container</h2>
<p>The image can also be used to create the source files.</p>
<pre tabindex="0"><code>docker run -it -v ${PWD}:${PWD} &#39;ghcr.io/cmahnke/iiif-action:latest-jxl&#39; /bin/bash -c &#34;cd ${PWD}; $SHELL&#34;
</code></pre><h2 id="file-conversion">File conversion</h2>
<p>Using <code>vips</code> directly has the advantage that you can use any supported input file format.</p>
<pre tabindex="0"><code>vips copy front.tif front.jxl[Q=100]
</code></pre><p>The following issues have been discovered:</p>
<ul>
<li><code>vips jxlsave</code> does not support parameters</li>
<li>The parameter <code>effort</code> can lead to a crash if it is greater than <code>7</code> - might be a memory problem, not yet tested with <code>cjxl</code></li>
</ul>
<p><code>cjxl</code> can also be used, but you should use a losslessly compressed (e.g. PNG) input file:</p>
<pre tabindex="0"><code>cjxl front.png front.jxl
</code></pre><p>The possible options are linked here:</p>
<ul>
<li><a href="https://github.com/libvips/libvips/blob/add-jxl/libvips/foreign/jxlsave.c" target="_blank"><code>vips jxlsave</code></a></li>
<li><a href="https://gitlab.com/wg1/jpeg-xl/-/blob/master/doc/man/cjxl.txt" target="_blank"><code>cjxl</code></a></li>
</ul>
<h2 id="options">Options</h2>
<p>Since the use of JPEG XL is primarily intended here to reduce the storage requirement and with the same or higher quality, it is important to take this into account during the conversion. If possible, the processed master images (i.e. uncompressed image data) should be used directly to create the derivatives. JPEG files (ImageMagick quality level 95) are currently the source material for creating IIIF derivates.</p>
<p><a href="https://github.com/google/butteraugli" target="_blank"><code>butteraugli</code></a> is used to assess the quality.</p>
<h3 id="generate-comparison-file">Generate comparison file</h3>
<pre tabindex="0"><code>convert front.tif -quality 95 front.jpg
</code></pre><p><code>butteraugli</code> can read JPEG or PNG files.</p>
<h2 id="results">Results</h2>
<p>This post does not claim to achieve the most optimal results. In addition, the JPEG XL encoder is very memory-hungry and can therefore not be fully tried out in the Docker environment. For these reasons there are no benchmarks, comparisons of file sizes, etc.</p>
<p>Basically what was known at the beginning remains: files are smaller with a similar quality.</p>
<h1 id="iiif">IIIF</h1>
<p>After you have created a few JPEG XL files, you can now generate IIIF derivatives:</p>
<pre tabindex="0"><code>vips dzsave front.jxl front -t 512 --layout iiif
</code></pre><div class="iiif">
  <div id="_iiif-presentation-28158dbcb7cb8d5033bd9d078c9d04f0" class="viewer presentation-api portrait"></div>
  <script type="text/javascript">
    var viewer = iiifPresentationViewer('#_iiif-presentation-28158dbcb7cb8d5033bd9d078c9d04f0', 'https:\/\/christianmahnke.de\/en\/post\/jpeg-xl\/manifest.json');
  </script>
</div></div>
  </div><div class="post-footer"><div class="spacer">
      </div>
      <div class="meta"><div class="tags-heading">Tags</div>
        <div class="tags"><a href="https://christianmahnke.de/en/tags/DigitalImages" title="Digital images">#Digital images</a><a href="https://christianmahnke.de/en/tags/Projektemacher.org" title="Projektemacher.org">#Projektemacher.org</a><a href="https://christianmahnke.de/en/tags/IIIF" title="IIIF">#IIIF</a></div>
      </div>
    </div>
  
</div>

  </div>

        </div><footer class="footer" role="contentinfo">
    <div class="spacer"></div>
    <div class="content">
        <div class="wrapper">
            <div class="menu-wrapper">
                <div class="footer-nav">
                    <h3 class="footer-nav">Navigation</h3>
                    <nav class="top top-menu">
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="menu-icon"></i></label>
    <ul class="navigation-list"><li class="navigation-item navto-"><a class="navigation-link" href="https://christianmahnke.de/en/" title="Focuses">Focuses<i class="link-icon"></i></a></li><li class="navigation-item navto-collections"><a class="navigation-link" href="https://christianmahnke.de/en/collections" title="Collections">Collections<i class="link-icon"></i></a></li><li class="navigation-item current navto-post"><a class="navigation-link" href="https://christianmahnke.de/en/post" title="Blog">Blog<i class="link-icon"></i></a></li><li class="navigation-item navto-links"><a class="navigation-link" href="https://christianmahnke.de/en/links" title="Links">Links<i class="link-icon"></i></a></li><li class="navigation-item navto-about"><a class="navigation-link" href="https://christianmahnke.de/en/about" title="About">About<i class="link-icon"></i></a></li><li class="navigation-item navto-search"><form action="https://christianmahnke.de/en/search/" method="get" class="search-form" id="menu-search-form"><input name="q" type="text" placeholder="Search" class="search-input" id="menu-search-input"><button type="submit" class="search-button" id="menu-search-button"><i class="search-icon"></i></button></form></li><li class="navigation-item lang">
              <a href="https://christianmahnke.de/post/jpeg-xl/" title="Deutsch">Deutsch</a>
            </li></ul>
  </nav>
                </div>
            </div>
            <div class="link-wrapper">
                <h3 class="footer-links">Links</h3>
                <ul class="footer-links"><li class="footer-link"><a href="https://github.com/cmahnke" target="_blank" title="GitHub"><div class="link-image github"></div>GitHub</a></li><li class="footer-link"><a href="https://projektemacher.org/" target="_blank" title="Projektemacher"><img class="link-image projektemacher" alt="Projektemacher Logo" src="https://christianmahnke.de/images/laborant.svg">Projektemacher</a></li><li class="footer-link"><a href="https://orcid.org/0009-0003-1361-4159" target="_blank" title="ORCID"><div class="link-image orcid"></div>0009-0003-1361-4159</a></li><li class="footer-link"><a href="https://www.linkedin.com/in/cmahnke" target="_blank" title="LinkedIn"><div class="link-image linkedin"></div>LinkedIn</a></li><li class="footer-link"><a href="https://www.librarything.com/profile/cmahnke" target="_blank" title="LibraryThing"><div class="link-image librarything"></div>LibraryThing</a></li><li class="footer-link"><a href="https://openbiblio.social/@cmahnke" rel="me" target="_blank" title="Mastodon"><div class="link-image mastodon"></div>@cmahnke@openbiblio.social</a></li><li class="footer-link"><a href="https://www.instagram.com/projektemacher/" target="_blank" title="Instagram" style="display: none;"><div class="link-image instagram"></div>Instagram</a></li><li class="footer-link"><a href="https://term.museum-digital.de/md-de/persinst/322830" target="_blank" title="museum:digital" style="display: none;"><div class="link-image md-term"></div>museum:digital</a></li></ul>
            </div>
            <div class="footer-placeholder"></div>
            <div class="contact-wrapper">
                <h3 class="footer-contact">Contact</h3><div class="footer-contact"><h4 class="contact-link">Mail</h4><a href="mailto:mail@christianmahnke.de" title="Send eMail">mail@christianmahnke.de</a></div><h3 class="footer-privacy"><a href="https://christianmahnke.de/privacy" title="Privacy policy">Privacy policy</a></h3>
                <h1 class=footer-title><img class="footer-icon" alt="Projektemacher.org" src="https://christianmahnke.de/images/cm-black.svg">Christian Mahnke</h1>
            </div>
        </div>
    </div>
    <div class="copyright"><a href="https://christianmahnke.de">&copy; MMXXI - MMXXV Christian Mahnke</a>
        <span class="icons-right"><a href="https://projektemacher.org"><img class="icon" alt="Projektemacher.org" src="https://christianmahnke.de/images/cm.svg"></a></span>
    </div>

</footer>


<script type="text/javascript">
    document.querySelector(".type-text")&&!document.querySelector(".subsection")?enterView({selector:".type-text",enter:function(e){e.classList.add("show")},offset:.25,once:!0}):document.querySelector(".type-text")&&document.querySelectorAll(".type-text").forEach(e=>e.classList.add("show","instant")),document.querySelector(".iframe-wrapper")&&enterView({selector:".iframe-wrapper",enter:function(e){e.classList.add("show")},offset:.45,once:!0}),document.addEventListener("DOMContentLoaded",function(){document.querySelector(".backToTop").removeAttribute("href"),document.addEventListener("scroll",function(){window.scrollY>window.innerHeight?document.querySelector("#head").classList.add("show-top-button"):document.querySelector("#head").classList.remove("show-top-button")})})
</script>
</div>
    </body>
 </html>
