<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Christian Mahnke</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="author" content="Christian Mahnke"><meta name="subject" content="Christian Mahnke"/>
    
    
    <meta name="date" content="22 Feb 2026"/>
    <link rel="stylesheet" href="https://christianmahnke.de/css/print.3fdda9b5c5f73002a47a284c8c3f1b5e564d7995c30d17c14c4bc3ca7c0a4ea2.css" type="text/css" integrity="sha256-P92ptcX3MAKkeihMjD8bXlZNeZXDDRfBTEvDynwKTqI=">
  </head>
  <body>
    <header class="header header-main" id="head" data-sticky-class="sticky-top">
    <div class="wrapper">
        <label class="menu-open" for="menu-toggle">
            <i class="menu-open-icon"></i>
        </label>
        <div class="menu">
            <nav class="top top-menu">
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="menu-icon"></i></label>
    <ul class="navigation-list"><li class="navigation-item navto-"><a class="navigation-link" href="https://christianmahnke.de/en/" title="Focuses">Focuses<i class="link-icon"></i></a></li><li class="navigation-item navto-collections"><a class="navigation-link" href="https://christianmahnke.de/en/collections" title="Collections">Collections<i class="link-icon"></i></a></li><li class="navigation-item current navto-post"><a class="navigation-link" href="https://christianmahnke.de/en/post" title="Blog">Blog<i class="link-icon"></i></a></li><li class="navigation-item navto-links"><a class="navigation-link" href="https://christianmahnke.de/en/links" title="Links">Links<i class="link-icon"></i></a></li><li class="navigation-item navto-about"><a class="navigation-link" href="https://christianmahnke.de/en/about" title="About">About<i class="link-icon"></i></a></li><li class="navigation-item navto-search"><form action="https://christianmahnke.de/en/search/" method="get" class="search-form" id="menu-search-form"><input name="q" type="text" placeholder="Search" class="search-input" id="menu-search-input"><button type="submit" class="search-button" id="menu-search-button"><i class="search-icon"></i></button></form></li><li class="navigation-item lang">
              <a href="https://christianmahnke.de/post/gitlab-debian-repository/article.html" title="Deutsch">Deutsch</a>
            </li></ul>
  </nav>
        </div>
        <div class="home-link">
            <a href="https://christianmahnke.de/"><h1 class="header-title">Christian Mahnke</h1></a>
        </div></div>
    <div class="header-spacer"></div>
    <a href="#top">
        <div class="backToTop"></div>
    </a>
</header>
<div class="content-container single">
    <div class="post ">
  <div class="content">
      <h1 class="post-title">Debian Repository with GitLab Pages</h1><div class="date">
          <time class="post-data" datetime="2025-08-08T18:33:44&#43;02:00">Friday, August 8, 2025</time>
        </div><div class="post-body"><p>A simple Debian repository knitted by yourself&hellip;</p>
<p>Sometimes you need your own Debian repository, e.g. to install <a href="https://www.electronjs.org/" target="_blank">Electron</a> applications with <a href="https://github.com/raspberrypi/rpi-image-gen" target="_blank"><code>rpi-image-gen</code></a>.</p>
<p>Even if GitLab has an <a href="https://docs.gitlab.com/user/packages/debian_repository/" target="_blank">experimental feature</a> for this, it is not activated on every instance.</p>
<h1 id="create-repository">Create repository</h1>
<p>Basically there are two ways or tools to create static Debian package repositories, <code>dpkg-scanpackages</code> and <code>reprepro</code>. The following examples assume that there is another one called <code>debian</code> below the working directory. This contains one or more &ldquo;<code>.deb</code>&rdquo; files.</p>
<h2 id="dpkg-scanpackages"><code>dpkg-scanpackages</code></h2>
<p>This is the simpler variant. First, the package <code>dpkg-dev</code> must be installed (<code>apt install -y dpkg-dev</code>). The program can then be executed with the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dpkg-scanpackages -m debian /dev/null <span class="p">|</span> gzip -9c &gt; debian/Packages.gz
</span></span></code></pre></div><p>The <code>debian</code> directory can then be made available on a web storage area.</p>
<h2 id="reprepro"><code>reprepro</code></h2>
<p>This is the variant that offers more possibilities, first the package <code>reprepro</code> must be installed (<code>apt install -y reprepro</code>). This variant has the advantage that you can also provide GPG keys&hellip;</p>
<p>Since configuration files must also be created here, it is recommended to create an additional shell script in the repository:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">REPO_DIR</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -p <span class="nv">$REPO_DIR</span>/<span class="o">{</span>conf,incoming,debian<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">RELEASE_NAME</span><span class="o">=</span>bookworm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Using </span><span class="nv">$REPO_DIR</span><span class="s2"> as local repository&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF &gt;&gt; $REPO_DIR/conf/distributions
</span></span></span><span class="line"><span class="cl"><span class="s">Origin: My Electron App
</span></span></span><span class="line"><span class="cl"><span class="s">Label: My Electron App
</span></span></span><span class="line"><span class="cl"><span class="s">Suite: stable
</span></span></span><span class="line"><span class="cl"><span class="s">Codename: $RELEASE_NAME
</span></span></span><span class="line"><span class="cl"><span class="s">Architectures: arm64 armhf
</span></span></span><span class="line"><span class="cl"><span class="s">Components: main
</span></span></span><span class="line"><span class="cl"><span class="s">Description: Personal Electron App software repository
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="nv">$REPO_DIR</span>
</span></span><span class="line"><span class="cl">reprepro createsymlinks
</span></span><span class="line"><span class="cl">reprepro <span class="nb">export</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> DEB in <span class="sb">`</span>find <span class="nv">$REPO_DIR</span>/debian/ -name <span class="s2">&#34;*.deb&#34;</span> -type f<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Adding </span><span class="nv">$DEB</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    reprepro -b <span class="nv">$REPO_DIR</span> includedeb <span class="s2">&#34;</span><span class="nv">$RELEASE_NAME</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$DEB</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></div><p><code>reprepro</code> also offers <a href="https://wiki.debian.org/DebianRepository/SetupWithReprepro" target="_blank">further parameters and options</a>.</p>
<h1 id="create-directory-index">Create directory index</h1>
<p>This step is optional and requires the programs <code>tree</code>and <code>find</code> (<code>apt install -y tree findutils</code>). <code>tree</code> can create directory listings in HTML format, <code>find</code> is used to run <code>tree</code> recursively:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find . -type d -print -exec sh -c <span class="s1">&#39;tree &#34;$0&#34; -H &#34;.&#34; -L 1 --noreport --houtro &#34;&#34; --dirsfirst --charset utf-8 -I &#34;index.html&#34; --timefmt &#34;%d-%b-%Y %H:%M&#34; -s -D -o &#34;$0/index.html&#34;&#39;</span> <span class="o">{}</span> <span class="se">\;</span>
</span></span></code></pre></div><h1 id="deployment-on-the-web---example-for-gitlab">Deployment on the Web - Example for GitLab</h1>
<p>This simple example creates a Debian repository on GitLab Pages.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># This collects all *.deb files from the workdir and creates the package index</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nt">packages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">debian:bookworm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">repo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">before_script</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">apt-get update</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">apt-get install -y dpkg-dev tree findutils</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">mkdir -p repo/debian</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">find . -name &#39;*.deb&#39; -print -exec cp {} repo/debian/ \;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cd repo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">find . -type d -print -exec sh -c &#39;tree &#34;$0&#34; -H &#34;.&#34; -L 1 --noreport --houtro &#34;&#34; --dirsfirst --charset utf-8 -I &#34;index.html&#34; --timefmt &#34;%d-%b-%Y %H:%M&#34; -s -D -o &#34;$0/index.html&#34;&#39; {} \;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">dpkg-scanpackages -m debian /dev/null | gzip -9c &gt; debian/Packages.gz</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="c"># This depends on the artifacts of the `packages` step and deploys them on GitLab pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nt">pages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">needs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">packages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">script</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">mkdir -p public</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cp -r repo/debian public/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">artifacts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">public</span><span class="w">
</span></span></span></code></pre></div></div>
  </div><div class="post-footer"><ul class="wikidata-summary">
    <div class="wikidata-title">Entites in this post (Wikidata)</div><li class="wikidata-entry"><a href="http://www.wikidata.org/entity/Q16639197" title="Q16639197" rel="related">Wikidata entry: Q16639197</a>
      </li><li class="wikidata-entry"><a href="http://www.wikidata.org/entity/Q7715973" title="Q7715973" rel="related">Wikidata entry: Q7715973</a>
      </li></ul><div class="spacer">
      </div>
      <div class="meta"><div class="cite-container"><details class="cite">
  <summary class="cite_summary">
    Cite this article
  </summary><div class="cite-body">
    <div class="cite-proposal">
      <span class="cite-author">Mahnke, Christian</span> <span class="cite-year">(2025)</span>: <span class="cite-title">Debian Repository with GitLab Pages</span>. In:  <a class="cite-source-link" href="https://christianmahnke.de/">ChristianMahnke.de</a> [Weblog], Aug 8, 2025. Online publication: <a class="cite-link" href="https://christianmahnke.de/post/gitlab-debian-repository/article.html">https://christianmahnke.de/post/gitlab-debian-repository/article.html</a>.
    </div>
    <a class="bibtex-download" href="https://christianmahnke.de/en/post/gitlab-debian-repository/citation.bib" title="Download as BibTex">Download as BibTex</a>
  </div>
</details>
</div><div class="tags-heading">Tags</div>
        <div class="tags"><a href="https://christianmahnke.de/en/tags/Git" title="Git">#Git</a><a href="https://christianmahnke.de/en/tags/SoftwareDevelopment" title="Software development">#Software development</a></div>
      </div>
    </div></div><div class="related-posts">
    
      <div class="related-header">Related posts:</div>
      <ul>
        
          <li><a href="https://christianmahnke.de/en/post/vite-git-symlink-plugin/article.html">Vite und Git Symlink-Dateien</a></li>
        
          <li><a href="https://christianmahnke.de/en/post/academic-software-publishing/article.html">AI and software &#34;development&#34;</a></li>
        
          <li><a href="https://christianmahnke.de/en/post/software-metadata/article.html">Metadaten f√ºr Software</a></li>
        
          <li><a href="https://christianmahnke.de/en/post/hugo-cff-codemeta/article.html">CFF zu CodeMeta in Hugo</a></li>
        
      </ul>
    
  </div>
  </div>

  </body>
</html>
